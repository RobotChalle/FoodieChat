{"ast":null,"code":"import React,{useEffect,useState}from'react';import axios from'axios';import NavBar from'../components/NavBar.js';import'./css/admin.css';import'./css/main.css';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const PAGE_SIZE=10;axios.defaults.baseURL='http://localhost:8080';axios.defaults.withCredentials=true;export default function AdminPage(){const[users,setUsers]=useState([]);const[totalUsers,setTotalUsers]=useState(0);const[currentPage,setCurrentPage]=useState(1);const[searchKeyword,setSearchKeyword]=useState('');const fetchUsers=async page=>{try{const response=await axios.get(`/users/admin/users?page=${page}&size=${PAGE_SIZE}`);setUsers(response.data.users);setTotalUsers(response.data.total);}catch(error){console.error('❌ 유저 불러오기 실패:',error);}};const deleteUser=async userId=>{if(window.confirm('정말로 이 사용자를 삭제하시겠습니까?')){try{console.error(userId);await axios.delete(`/users/admin/users/${userId}`);fetchUsers(currentPage);}catch(error){console.error('❌ 삭제 실패:',error);}}};const handleLevelChange=async(userId,newLevel)=>{try{await axios.patch(`/users/admin/users/${userId}/membership`,{membership_level:newLevel},{headers:{\"Content-Type\":\"application/json\"}});alert(\"등급이 성공적으로 변경되었습니다.\");fetchUsers(currentPage);}catch(error){console.error(\"❌ 등급 변경 실패:\",error);alert(\"등급 변경 실패\");}};useEffect(()=>{fetchUsers(currentPage);},[currentPage]);const totalPages=Math.ceil(totalUsers/PAGE_SIZE);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(NavBar,{}),/*#__PURE__*/_jsx(\"div\",{className:\"admin-wrapper\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"admin-inner\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"section-title\",children:\"\\uD68C\\uC6D0 \\uBAA9\\uB85D\"}),/*#__PURE__*/_jsx(\"div\",{className:\"search-row\",children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"search-input\",placeholder:\"\\uC774\\uBA54\\uC77C \\uB610\\uB294 \\uC774\\uB984\\uC73C\\uB85C \\uAC80\\uC0C9\",value:searchKeyword,onChange:e=>setSearchKeyword(e.target.value)})}),/*#__PURE__*/_jsxs(\"table\",{className:\"admin-table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"\\uC720\\uC800 ID\"}),/*#__PURE__*/_jsx(\"th\",{children:\"\\uC774\\uBA54\\uC77C\"}),/*#__PURE__*/_jsx(\"th\",{children:\"\\uB4F1\\uAE09\"}),/*#__PURE__*/_jsx(\"th\",{children:\"\\uAC00\\uC785\\uC77C\"}),/*#__PURE__*/_jsx(\"th\",{children:\"\\uC0AD\\uC81C\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:users.filter(user=>{var _user$name;return user.email.toLowerCase().includes(searchKeyword.toLowerCase())||((_user$name=user.name)===null||_user$name===void 0?void 0:_user$name.toLowerCase().includes(searchKeyword.toLowerCase()));}).map(user=>{var _user$membership_leve;return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:user.user_id}),/*#__PURE__*/_jsx(\"td\",{children:user.email}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"select\",{className:\"dropdown-select\",value:(_user$membership_leve=user.membership_level)===null||_user$membership_leve===void 0?void 0:_user$membership_leve.toLowerCase(),onChange:e=>handleLevelChange(user.user_id,e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"regular\",children:\"\\uAE30\\uBCF8\"}),/*#__PURE__*/_jsx(\"option\",{value:\"business\",children:\"\\uBE44\\uC988\\uB2C8\\uC2A4\"}),/*#__PURE__*/_jsx(\"option\",{value:\"admin\",children:\"\\uAD00\\uB9AC\\uC790\"})]})}),/*#__PURE__*/_jsx(\"td\",{children:user.join_date}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-danger\",onClick:()=>deleteUser(user.user_id),children:\"\\uC0AD\\uC81C\"})})]},user.user_id);})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"pagination\",children:[...Array(totalPages)].map((_,i)=>/*#__PURE__*/_jsx(\"button\",{className:`page-button ${currentPage===i+1?'active':''}`,onClick:()=>setCurrentPage(i+1),children:i+1},i))})]})})]});}","map":{"version":3,"names":["React","useEffect","useState","axios","NavBar","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","PAGE_SIZE","defaults","baseURL","withCredentials","AdminPage","users","setUsers","totalUsers","setTotalUsers","currentPage","setCurrentPage","searchKeyword","setSearchKeyword","fetchUsers","page","response","get","data","total","error","console","deleteUser","userId","window","confirm","delete","handleLevelChange","newLevel","patch","membership_level","headers","alert","totalPages","Math","ceil","children","className","type","placeholder","value","onChange","e","target","filter","user","_user$name","email","toLowerCase","includes","name","map","_user$membership_leve","user_id","join_date","onClick","Array","_","i"],"sources":["D:/workspace/FoodyChat/foodychat_frontend/src/components/AdminPage.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport axios from 'axios';\r\nimport NavBar from '../components/NavBar.js';\r\nimport './css/admin.css';\r\nimport './css/main.css';\r\nconst PAGE_SIZE = 10;\r\naxios.defaults.baseURL = 'http://localhost:8080';\r\naxios.defaults.withCredentials = true;\r\nexport default function AdminPage() {\r\n  const [users, setUsers] = useState([]);\r\n  const [totalUsers, setTotalUsers] = useState(0);\r\n  const [currentPage, setCurrentPage] = useState(1);\r\n  const [searchKeyword, setSearchKeyword] = useState('');\r\n\r\n  const fetchUsers = async (page) => {\r\n    try {\r\n      const response = await axios.get(`/users/admin/users?page=${page}&size=${PAGE_SIZE}`);\r\n      setUsers(response.data.users);\r\n      setTotalUsers(response.data.total);\r\n    } catch (error) {\r\n      console.error('❌ 유저 불러오기 실패:', error);\r\n    }\r\n  };\r\n\r\n  const deleteUser = async (userId) => {\r\n    if (window.confirm('정말로 이 사용자를 삭제하시겠습니까?')) {\r\n      try {\r\n        console.error(userId)\r\n        await axios.delete(`/users/admin/users/${userId}`);\r\n        fetchUsers(currentPage);\r\n      } catch (error) {\r\n        console.error('❌ 삭제 실패:', error);\r\n      }\r\n    }\r\n  };\r\n  const handleLevelChange = async (userId, newLevel) => {\r\n    try {\r\n      await axios.patch(\r\n        `/users/admin/users/${userId}/membership`,\r\n        { membership_level: newLevel },\r\n        {\r\n          headers: {\r\n            \"Content-Type\": \"application/json\",\r\n          },\r\n        }\r\n      );\r\n      alert(\"등급이 성공적으로 변경되었습니다.\");\r\n      fetchUsers(currentPage);\r\n    } catch (error) {\r\n      console.error(\"❌ 등급 변경 실패:\", error);\r\n      alert(\"등급 변경 실패\");\r\n    }\r\n  };\r\n  \r\n  useEffect(() => {\r\n    fetchUsers(currentPage);\r\n  }, [currentPage]);\r\n\r\n  const totalPages = Math.ceil(totalUsers / PAGE_SIZE);\r\n\r\n  return (\r\n    <>\r\n    <NavBar />\r\n    <div className=\"admin-wrapper\">\r\n      <div className=\"admin-inner\">\r\n      <h2 className=\"section-title\">회원 목록</h2>\r\n        <div className=\"search-row\">\r\n          <input\r\n            type=\"text\"\r\n            className=\"search-input\"\r\n            placeholder=\"이메일 또는 이름으로 검색\"\r\n            value={searchKeyword}\r\n            onChange={(e) => setSearchKeyword(e.target.value)}\r\n          />\r\n        </div>\r\n\r\n        <table className=\"admin-table\">\r\n          <thead>\r\n            <tr>\r\n              <th>유저 ID</th>\r\n              <th>이메일</th>\r\n              <th>등급</th>\r\n              <th>가입일</th>\r\n              <th>삭제</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {users\r\n            .filter(user =>\r\n              user.email.toLowerCase().includes(searchKeyword.toLowerCase()) ||\r\n              user.name?.toLowerCase().includes(searchKeyword.toLowerCase())\r\n            )\r\n            .map(user => (\r\n\r\n              <tr key={user.user_id}>\r\n                <td>{user.user_id}</td>\r\n                <td>{user.email}</td>\r\n                <td>\r\n                <select\r\n                className=\"dropdown-select\"\r\n                value={user.membership_level?.toLowerCase()}\r\n              onChange={(e) => handleLevelChange(user.user_id, e.target.value)}\r\n                >\r\n                  <option value=\"regular\">기본</option>\r\n                  <option value=\"business\">비즈니스</option>\r\n                  <option value=\"admin\">관리자</option>\r\n                </select>\r\n                </td>\r\n                <td>{user.join_date}</td>\r\n                <td>\r\n                  <button className=\"btn btn-danger\" onClick={() => deleteUser(user.user_id)}>삭제</button>\r\n                </td>\r\n              </tr>\r\n            ))}\r\n          </tbody>\r\n        </table>\r\n\r\n        <div className=\"pagination\">\r\n          {[...Array(totalPages)].map((_, i) => (\r\n            <button\r\n              key={i}\r\n              className={`page-button ${currentPage === i + 1 ? 'active' : ''}`}\r\n              onClick={() => setCurrentPage(i + 1)}\r\n            >\r\n              {i + 1}\r\n            </button>\r\n          ))}\r\n        </div>\r\n      </div>\r\n    </div>\r\n    </>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}