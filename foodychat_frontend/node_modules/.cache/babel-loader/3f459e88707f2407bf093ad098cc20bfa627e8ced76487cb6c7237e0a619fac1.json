{"ast":null,"code":"import{useEffect,useState}from\"react\";import axios from\"axios\";import NavBar from'./NavBar';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function ChatTest(){const[userId,setUserId]=useState(null);const[question,setQuestion]=useState(\"\");const[answer,setAnswer]=useState(\"\");const[loading,setLoading]=useState(false);useEffect(()=>{axios.get(\"http://localhost:8080/users/user-id\",{withCredentials:true}).then(res=>setUserId(res.data)).catch(err=>{console.error(\"❌ 유저 정보 로딩 실패\",err);});},[]);const handleSend=async()=>{if(!question.trim())return;if(!userId){setAnswer(\"❗ 로그인한 유저만 질문할 수 있습니다.\");return;}setLoading(true);setAnswer(\"\");// 로딩 중 이전 응답 초기화\ntry{const res=await axios.post(\"http://localhost:8000/chat/chat\",{user_id:userId,question});setAnswer(res.data.answer);}catch(err){var _err$response,_err$response$data;setAnswer(`⚠️ 서버 오류: ${((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.detail)||err.message}`);}finally{setLoading(false);}};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(NavBar,{}),/*#__PURE__*/_jsxs(\"div\",{style:styles.container,children:[/*#__PURE__*/_jsx(\"h1\",{style:styles.header,children:\"\\uD83E\\uDD16 Gemini \\uCC57\\uBD07\"}),!userId?/*#__PURE__*/_jsx(\"p\",{style:styles.status,children:\"\\uD83D\\uDD10 \\uB85C\\uADF8\\uC778 \\uC720\\uC800 \\uC815\\uBCF4\\uB97C \\uBD88\\uB7EC\\uC624\\uB294 \\uC911\\uC785\\uB2C8\\uB2E4...\"}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{style:styles.chatBox,children:[question&&/*#__PURE__*/_jsx(\"div\",{style:{...styles.bubble,...styles.userBubble},children:question}),loading?/*#__PURE__*/_jsx(\"div\",{style:{...styles.bubble,...styles.botBubble},children:/*#__PURE__*/_jsx(\"span\",{className:\"blinking\",children:\"\\uD83D\\uDCAC \\uC0DD\\uAC01 \\uC911...\"})}):answer&&/*#__PURE__*/_jsx(\"div\",{style:{...styles.bubble,...styles.botBubble},children:/*#__PURE__*/_jsx(\"pre\",{style:styles.pre,children:answer})})]}),/*#__PURE__*/_jsxs(\"div\",{style:styles.inputArea,children:[/*#__PURE__*/_jsx(\"textarea\",{value:question,onChange:e=>setQuestion(e.target.value),placeholder:\"\\uC9C8\\uBB38\\uC744 \\uC785\\uB825\\uD558\\uC138\\uC694\",rows:\"4\",style:styles.textarea}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSend,disabled:loading,style:styles.button,children:loading?\"전송 중...\":\"질문 보내기\"})]})]})]})]});}const styles={container:{maxWidth:\"800px\",margin:\"0 auto\",padding:\"2rem\",fontFamily:\"Segoe UI, sans-serif\",background:\"#f9f9f9\",minHeight:\"100vh\"},header:{fontSize:\"2rem\",marginBottom:\"1rem\",textAlign:\"center\",color:\"#333\"},status:{fontStyle:\"italic\",color:\"#666\"},chatBox:{display:\"flex\",flexDirection:\"column\",gap:\"1rem\",marginBottom:\"1.5rem\",padding:\"1rem\",backgroundColor:\"#fff\",borderRadius:\"12px\",boxShadow:\"0 2px 8px rgba(0,0,0,0.05)\",minHeight:\"200px\"},bubble:{padding:\"0.75rem 1rem\",borderRadius:\"16px\",maxWidth:\"100%\",// ✅ 전체 컨테이너 기준 최대\nwordBreak:\"break-word\",// ✅ 단어 분할 허용\noverflowWrap:\"break-word\",// ✅ 줄바꿈\nwhiteSpace:\"pre-wrap\",// ✅ 개행 유지 + 자동 줄바꿈\nlineHeight:\"1.6\"},userBubble:{backgroundColor:\"#DCF8C6\",alignSelf:\"flex-end\"},botBubble:{backgroundColor:\"#ECECEC\",alignSelf:\"flex-start\"},inputArea:{display:\"flex\",flexDirection:\"column\",gap:\"0.5rem\"},textarea:{width:\"100%\",padding:\"1rem\",fontSize:\"1rem\",borderRadius:\"8px\",border:\"1px solid #ccc\",resize:\"none\"},button:{alignSelf:\"flex-end\",backgroundColor:\"#4F46E5\",color:\"#fff\",padding:\"0.75rem 1.25rem\",border:\"none\",borderRadius:\"8px\",cursor:\"pointer\",fontSize:\"1rem\"},pre:{margin:0,fontFamily:\"inherit\",wordBreak:\"break-word\",overflowWrap:\"break-word\",whiteSpace:\"pre-wrap\"}};export default ChatTest;","map":{"version":3,"names":["useEffect","useState","axios","NavBar","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","ChatTest","userId","setUserId","question","setQuestion","answer","setAnswer","loading","setLoading","get","withCredentials","then","res","data","catch","err","console","error","handleSend","trim","post","user_id","_err$response","_err$response$data","response","detail","message","children","style","styles","container","header","status","chatBox","bubble","userBubble","botBubble","className","pre","inputArea","value","onChange","e","target","placeholder","rows","textarea","onClick","disabled","button","maxWidth","margin","padding","fontFamily","background","minHeight","fontSize","marginBottom","textAlign","color","fontStyle","display","flexDirection","gap","backgroundColor","borderRadius","boxShadow","wordBreak","overflowWrap","whiteSpace","lineHeight","alignSelf","width","border","resize","cursor"],"sources":["D:/workspace/FoodyChat/foodychat_frontend/src/components/ChatTest.js"],"sourcesContent":["import { useEffect, useState } from \"react\";\r\nimport axios from \"axios\";\r\nimport NavBar from './NavBar';\r\n\r\nfunction ChatTest() {\r\n  const [userId, setUserId] = useState(null);\r\n  const [question, setQuestion] = useState(\"\");\r\n  const [answer, setAnswer] = useState(\"\");\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  useEffect(() => {\r\n    axios.get(\"http://localhost:8080/users/user-id\", { withCredentials: true })\r\n      .then(res => setUserId(res.data))\r\n      .catch(err => {\r\n        console.error(\"❌ 유저 정보 로딩 실패\", err);\r\n      });\r\n  }, []);\r\n\r\n  const handleSend = async () => {\r\n    if (!question.trim()) return;\r\n    if (!userId) {\r\n      setAnswer(\"❗ 로그인한 유저만 질문할 수 있습니다.\");\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n    setAnswer(\"\"); // 로딩 중 이전 응답 초기화\r\n    try {\r\n      const res = await axios.post(\"http://localhost:8000/chat/chat\", {\r\n        user_id: userId,\r\n        question,\r\n      });\r\n      setAnswer(res.data.answer);\r\n    } catch (err) {\r\n      setAnswer(`⚠️ 서버 오류: ${err.response?.data?.detail || err.message}`);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n                <NavBar />\r\n      <div style={styles.container}>\r\n        <h1 style={styles.header}>🤖 Gemini 챗봇</h1>\r\n\r\n        {!userId ? (\r\n          <p style={styles.status}>🔐 로그인 유저 정보를 불러오는 중입니다...</p>\r\n        ) : (\r\n          <>\r\n            <div style={styles.chatBox}>\r\n              {/* 사용자 질문 말풍선 */}\r\n              {question && (\r\n                <div style={{ ...styles.bubble, ...styles.userBubble }}>\r\n                  {question}\r\n                </div>\r\n              )}\r\n\r\n              {/* 챗봇 응답 말풍선 */}\r\n              {loading ? (\r\n                <div style={{ ...styles.bubble, ...styles.botBubble }}>\r\n                  <span className=\"blinking\">💬 생각 중...</span>\r\n                </div>\r\n              ) : (\r\n                answer && (\r\n                  <div style={{ ...styles.bubble, ...styles.botBubble }}>\r\n                    <pre style={styles.pre}>{answer}</pre>\r\n                  </div>\r\n                )\r\n              )}\r\n            </div>\r\n\r\n            <div style={styles.inputArea}>\r\n              <textarea\r\n                value={question}\r\n                onChange={(e) => setQuestion(e.target.value)}\r\n                placeholder=\"질문을 입력하세요\"\r\n                rows=\"4\"\r\n                style={styles.textarea}\r\n              />\r\n              <button onClick={handleSend} disabled={loading} style={styles.button}>\r\n                {loading ? \"전송 중...\" : \"질문 보내기\"}\r\n              </button>\r\n            </div>\r\n          </>\r\n        )}\r\n      </div>\r\n      </>\r\n  );\r\n}\r\n\r\nconst styles = {\r\n  container: {\r\n    maxWidth: \"800px\",\r\n    margin: \"0 auto\",\r\n    padding: \"2rem\",\r\n    fontFamily: \"Segoe UI, sans-serif\",\r\n    background: \"#f9f9f9\",\r\n    minHeight: \"100vh\",\r\n  },\r\n  header: {\r\n    fontSize: \"2rem\",\r\n    marginBottom: \"1rem\",\r\n    textAlign: \"center\",\r\n    color: \"#333\",\r\n  },\r\n  status: {\r\n    fontStyle: \"italic\",\r\n    color: \"#666\",\r\n  },\r\n  chatBox: {\r\n    display: \"flex\",\r\n    flexDirection: \"column\",\r\n    gap: \"1rem\",\r\n    marginBottom: \"1.5rem\",\r\n    padding: \"1rem\",\r\n    backgroundColor: \"#fff\",\r\n    borderRadius: \"12px\",\r\n    boxShadow: \"0 2px 8px rgba(0,0,0,0.05)\",\r\n    minHeight: \"200px\",\r\n  },\r\n  bubble: {\r\n    padding: \"0.75rem 1rem\",\r\n    borderRadius: \"16px\",\r\n    maxWidth: \"100%\", // ✅ 전체 컨테이너 기준 최대\r\n    wordBreak: \"break-word\", // ✅ 단어 분할 허용\r\n    overflowWrap: \"break-word\", // ✅ 줄바꿈\r\n    whiteSpace: \"pre-wrap\", // ✅ 개행 유지 + 자동 줄바꿈\r\n    lineHeight: \"1.6\",\r\n  },\r\n  userBubble: {\r\n    backgroundColor: \"#DCF8C6\",\r\n    alignSelf: \"flex-end\",\r\n  },\r\n  botBubble: {\r\n    backgroundColor: \"#ECECEC\",\r\n    alignSelf: \"flex-start\",\r\n  },\r\n  inputArea: {\r\n    display: \"flex\",\r\n    flexDirection: \"column\",\r\n    gap: \"0.5rem\",\r\n  },\r\n  textarea: {\r\n    width: \"100%\",\r\n    padding: \"1rem\",\r\n    fontSize: \"1rem\",\r\n    borderRadius: \"8px\",\r\n    border: \"1px solid #ccc\",\r\n    resize: \"none\",\r\n  },\r\n  button: {\r\n    alignSelf: \"flex-end\",\r\n    backgroundColor: \"#4F46E5\",\r\n    color: \"#fff\",\r\n    padding: \"0.75rem 1.25rem\",\r\n    border: \"none\",\r\n    borderRadius: \"8px\",\r\n    cursor: \"pointer\",\r\n    fontSize: \"1rem\",\r\n  },\r\n  pre: {\r\n    margin: 0,\r\n    fontFamily: \"inherit\",\r\n    wordBreak: \"break-word\",\r\n    overflowWrap: \"break-word\",\r\n    whiteSpace: \"pre-wrap\",\r\n  },\r\n};\r\n\r\nexport default ChatTest;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}